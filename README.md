# Make å’Œ CMake å®Œæ•´æ•™ç¨‹

> ä»å…¥é—¨åˆ°è¿›é˜¶çš„ Make å’Œ CMake å®Œæ•´æ•™ç¨‹ï¼ŒåŸºäº Ubuntu å¹³å°ï¼ŒåŒ…å« 25 ä¸ªå®è·µæ¡ˆä¾‹

## ğŸ“š æ•™ç¨‹å†…å®¹

æœ¬æ•™ç¨‹åˆ†ä¸ºäº”ä¸ªéƒ¨åˆ†ï¼Œå…±çº¦ 12 ä¸‡å­—ï¼ŒåŒ…å« 25 ä¸ªå¯è¿è¡Œçš„ç¤ºä¾‹é¡¹ç›®ã€‚

### ç¬¬ä¸€éƒ¨åˆ†ï¼šMake åŸºç¡€å…¥é—¨ï¼ˆ`tutorial/01-make-basics.md`ï¼‰
- Make ç®€ä»‹ä¸ç¯å¢ƒå‡†å¤‡
- Makefile åŸºæœ¬è¯­æ³•ï¼ˆè§„åˆ™ã€å˜é‡ã€è‡ªåŠ¨åŒ–å˜é‡ï¼‰
- Make çš„å·¥ä½œåŸç†ï¼ˆä¾èµ–å›¾ã€æ—¶é—´æˆ³ã€å¢é‡ç¼–è¯‘ï¼‰

### ç¬¬äºŒéƒ¨åˆ†ï¼šMake è¿›é˜¶æŠ€å·§ï¼ˆ`tutorial/02-make-advanced.md`ï¼‰
- æ¨¡å¼è§„åˆ™ä¸éšå¼è§„åˆ™
- å‡½æ•°ä¸é«˜çº§å˜é‡
- ä¼ªç›®æ ‡ä¸ç‰¹æ®Šç›®æ ‡
- å¤šç›®å½•é¡¹ç›®ç»„ç»‡
- å¹¶è¡Œç¼–è¯‘ä¸ä¼˜åŒ–
- è°ƒè¯•ä¸å¸¸è§é—®é¢˜

### ç¬¬ä¸‰éƒ¨åˆ†ï¼šCMake åŸºç¡€å…¥é—¨ï¼ˆ`tutorial/03-cmake-basics.md`ï¼‰
- CMake ç®€ä»‹ä¸ä¼˜åŠ¿
- ç¬¬ä¸€ä¸ª CMakeLists.txt
- CMake åŸºæœ¬å‘½ä»¤
- CMake çš„å·¥ä½œåŸç†

### ç¬¬å››éƒ¨åˆ†ï¼šCMake è¿›é˜¶åº”ç”¨ï¼ˆ`tutorial/04-cmake-advanced*.md`ï¼‰
- ç›®æ ‡ï¼ˆTargetï¼‰ä¸å±æ€§
- æŸ¥æ‰¾ä¸ä½¿ç”¨å¤–éƒ¨åº“
- å¤šç›®å½•é¡¹ç›®ç»„ç»‡
- ç”Ÿæˆå™¨è¡¨è¾¾å¼
- è‡ªå®šä¹‰å‘½ä»¤ä¸ç›®æ ‡
- å®‰è£…ä¸æ‰“åŒ…
- äº¤å‰ç¼–è¯‘ä¸å·¥å…·é“¾
- æµ‹è¯•ä¸é›†æˆ
- Modern CMake æœ€ä½³å®è·µ
- è°ƒè¯•ä¸ä¼˜åŒ–

### ç¬¬äº”éƒ¨åˆ†ï¼šé™„å½•ï¼ˆ`tutorial/05-appendix.md`ï¼‰
- Linux åŸºç¡€çŸ¥è¯†è¡¥å……
- å®æˆ˜é¡¹ç›®
- å‚è€ƒèµ„æºå’Œé€ŸæŸ¥è¡¨

## ğŸš€ å¿«é€Ÿå¼€å§‹

### ç¯å¢ƒå‡†å¤‡

```bash
# Ubuntu/Debian
sudo apt update
sudo apt install build-essential cmake

# éªŒè¯å®‰è£…
make --version
cmake --version
gcc --version
```

### è¿è¡Œç¬¬ä¸€ä¸ªç¤ºä¾‹

**Make ç¤ºä¾‹ï¼š**
```bash
cd examples/make/01-hello-world
make
./hello
make clean
```

**CMake ç¤ºä¾‹ï¼š**
```bash
cd examples/cmake/01-hello-world
mkdir build && cd build
cmake ..
make
./hello
```

## ğŸ’» ç¤ºä¾‹ä»£ç 

### Make ç¤ºä¾‹ï¼ˆ12 ä¸ªï¼‰

| # | ç›®å½• | è¯´æ˜ | çŠ¶æ€ |
|---|------|------|------|
| 01 | `01-hello-world` | Hello World | âœ… |
| 02 | `02-variables` | å˜é‡å’Œè‡ªåŠ¨åŒ–å˜é‡ | âœ… |
| 03 | `03-single-file` | å•æ–‡ä»¶ç¼–è¯‘ | âœ… |
| 04 | `04-timestamp-demo` | æ—¶é—´æˆ³æ¼”ç¤º | âœ… |
| 05 | `05-pattern-rules` | æ¨¡å¼è§„åˆ™ | âœ… |
| 06 | `06-batch-compile` | æ‰¹é‡ç¼–è¯‘ | âœ… |
| 07 | `07-conditional-build` | æ¡ä»¶ç¼–è¯‘ | âœ… |
| 08 | `08-phony-targets` | ä¼ªç›®æ ‡ | âœ… |
| 09 | `09-complete-project` | å®Œæ•´é¡¹ç›® | âœ… |
| 10 | `10-multi-directory` | å¤šç›®å½•é¡¹ç›® | âœ… |
| 11 | `11-parallel-build` | å¹¶è¡Œç¼–è¯‘ | âš ï¸ éœ€å…ˆè¿è¡Œ generate.sh |
| 12 | `12-debugging` | è°ƒè¯•æŠ€å·§ | âœ… |

### CMake ç¤ºä¾‹ï¼ˆ13 ä¸ªï¼‰

| # | ç›®å½• | è¯´æ˜ | çŠ¶æ€ |
|---|------|------|------|
| 01 | `01-hello-world` | Hello World | âœ… |
| 02 | `02-library` | é™æ€åº“ | âœ… |
| 03 | `03-two-stages` | é…ç½®ç”Ÿæˆé˜¶æ®µ | âœ… |
| 04 | `04-makefile-analysis` | Makefile åˆ†æ | âœ… |
| 05 | `05-target-properties` | ç›®æ ‡å±æ€§ | âœ… |
| 06 | `06-find-package` | æŸ¥æ‰¾å¤–éƒ¨åº“ | âœ… |
| 07 | `07-multi-directory` | å¤šç›®å½•é¡¹ç›® | âœ… |
| 08 | `08-generator-expressions` | ç”Ÿæˆå™¨è¡¨è¾¾å¼ | âœ… |
| 09 | `09-custom-commands` | è‡ªå®šä¹‰å‘½ä»¤ | âœ… |
| 10 | `10-packaging` | æ‰“åŒ… | âœ… |
| 11 | `11-cross-compile` | äº¤å‰ç¼–è¯‘ | âœ… |
| 12 | `12-testing` | æµ‹è¯•æ¡†æ¶ | âœ… |
| 13 | `13-reusable-library` | å¯é‡ç”¨åº“ | âœ… |

**æ‰€æœ‰ç¤ºä¾‹å·²æµ‹è¯•é€šè¿‡ï¼** ğŸ‰

## ğŸ§ª æ‰¹é‡æµ‹è¯•

```bash
# æµ‹è¯•æ‰€æœ‰ Make ç¤ºä¾‹
./test_make_examples.sh

# æµ‹è¯•æ‰€æœ‰ CMake ç¤ºä¾‹
./test_cmake_examples.sh

# æµ‹è¯•å•ä¸ªç¤ºä¾‹ï¼ˆéœ€è¦å®‰è£… cmakeï¼‰
./test_examples.sh
```

## ğŸ“Š é¡¹ç›®ç»Ÿè®¡

- **æ•™ç¨‹æ–‡æ¡£**: 7 ä¸ªæ–‡ä»¶ï¼Œçº¦ 12 ä¸‡å­—
- **Make ç¤ºä¾‹**: 12 ä¸ªï¼Œ30+ æºæ–‡ä»¶
- **CMake ç¤ºä¾‹**: 13 ä¸ªï¼Œ35+ æºæ–‡ä»¶
- **æ€»è®¡**: 25 ä¸ªå®Œæ•´å¯è¿è¡Œç¤ºä¾‹ï¼Œ84+ æ–‡ä»¶

## ğŸ“– å­¦ä¹ è·¯å¾„

### åˆå­¦è€…è·¯å¾„ï¼ˆ4-6 å‘¨ï¼‰

**ç¬¬ 1 å‘¨ï¼šMake åŸºç¡€**
- é˜…è¯» `01-make-basics.md`
- è¿è¡Œç¤ºä¾‹ 01-04
- ç†è§£ Makefile è¯­æ³•å’Œå·¥ä½œåŸç†

**ç¬¬ 2 å‘¨ï¼šMake è¿›é˜¶**
- é˜…è¯» `02-make-advanced.md`
- è¿è¡Œç¤ºä¾‹ 05-12
- æŒæ¡æ¨¡å¼è§„åˆ™å’Œå¤šç›®å½•é¡¹ç›®

**ç¬¬ 3 å‘¨ï¼šCMake åŸºç¡€**
- é˜…è¯» `03-cmake-basics.md`
- è¿è¡Œç¤ºä¾‹ 01-04
- ç†è§£ CMakeLists.txt åŸºæœ¬ç”¨æ³•

**ç¬¬ 4-5 å‘¨ï¼šCMake è¿›é˜¶**
- é˜…è¯» `04-cmake-advanced*.md`
- è¿è¡Œç¤ºä¾‹ 05-13
- æŒæ¡ Modern CMake å’Œé«˜çº§ç‰¹æ€§

**ç¬¬ 6 å‘¨ï¼šå®è·µ**
- åº”ç”¨åˆ°è‡ªå·±çš„é¡¹ç›®
- å‚è€ƒé™„å½•çš„å®æˆ˜æ¡ˆä¾‹

### å¿«é€Ÿä¸Šæ‰‹è·¯å¾„ï¼ˆ1-2 å‘¨ï¼‰

é€‚åˆæœ‰ç»éªŒçš„å¼€å‘è€…ï¼Œç›´æ¥å­¦ä¹ å…³é”®ç« èŠ‚ï¼š
1. Make åŸºç¡€ + è¿›é˜¶ï¼ˆ2-3 å¤©ï¼‰
2. CMake åŸºç¡€ï¼ˆ1-2 å¤©ï¼‰
3. CMake è¿›é˜¶ï¼ˆ3-5 å¤©ï¼‰
4. å®è·µåº”ç”¨ï¼ˆå‰©ä½™æ—¶é—´ï¼‰

## ğŸ“‚ ç›®å½•ç»“æ„

```
make_cmake/
â”œâ”€â”€ README.md                          # æœ¬æ–‡ä»¶
â”œâ”€â”€ outline.md                         # æ•™å­¦å¤§çº²
â”œâ”€â”€ guide.md                          # åŸå§‹éœ€æ±‚
â”‚
â”œâ”€â”€ tutorial/                          # æ•™ç¨‹æ–‡æ¡£ï¼ˆçº¦ 12 ä¸‡å­—ï¼‰
â”‚   â”œâ”€â”€ 01-make-basics.md             # Make åŸºç¡€ï¼ˆ8.5Kï¼‰
â”‚   â”œâ”€â”€ 02-make-advanced.md           # Make è¿›é˜¶ï¼ˆ23Kï¼‰
â”‚   â”œâ”€â”€ 03-cmake-basics.md            # CMake åŸºç¡€ï¼ˆ19Kï¼‰
â”‚   â”œâ”€â”€ 04-cmake-advanced.md          # CMake è¿›é˜¶ 4.1-4.3ï¼ˆ18Kï¼‰
â”‚   â”œâ”€â”€ 04-cmake-advanced-part2.md    # CMake è¿›é˜¶ 4.4-4.6ï¼ˆ17Kï¼‰
â”‚   â”œâ”€â”€ 04-cmake-advanced-part3.md    # CMake è¿›é˜¶ 4.7-4.10ï¼ˆ23Kï¼‰
â”‚   â””â”€â”€ 05-appendix.md                # é™„å½•ï¼ˆ13Kï¼‰
â”‚
â”œâ”€â”€ examples/                          # ç¤ºä¾‹ä»£ç ï¼ˆ25 ä¸ªé¡¹ç›®ï¼‰
â”‚   â”œâ”€â”€ make/                          # Make ç¤ºä¾‹ï¼ˆ12 ä¸ªï¼‰
â”‚   â”‚   â”œâ”€â”€ 01-hello-world/
â”‚   â”‚   â”œâ”€â”€ 02-variables/
â”‚   â”‚   â”œâ”€â”€ ...
â”‚   â”‚   â””â”€â”€ 12-debugging/
â”‚   â”‚
â”‚   â””â”€â”€ cmake/                         # CMake ç¤ºä¾‹ï¼ˆ13 ä¸ªï¼‰
â”‚       â”œâ”€â”€ 01-hello-world/
â”‚       â”œâ”€â”€ 02-library/
â”‚       â”œâ”€â”€ ...
â”‚       â””â”€â”€ 13-reusable-library/
â”‚
â”œâ”€â”€ test_make_examples.sh              # Make ç¤ºä¾‹æµ‹è¯•è„šæœ¬
â”œâ”€â”€ test_cmake_examples.sh             # CMake ç¤ºä¾‹æµ‹è¯•è„šæœ¬
â””â”€â”€ test_examples.sh                   # å®Œæ•´æµ‹è¯•è„šæœ¬
```

## âœ¨ æ•™ç¨‹ç‰¹è‰²

1. **ç³»ç»Ÿå…¨é¢**: ä»åŸºç¡€åˆ°è¿›é˜¶ï¼Œè¦†ç›–æ‰€æœ‰é‡è¦çŸ¥è¯†ç‚¹
2. **å®è·µå¯¼å‘**: æ¯ä¸ªæ¦‚å¿µéƒ½é…æœ‰å¯è¿è¡Œçš„ç¤ºä¾‹ä»£ç 
3. **åŸç†è®²è§£**: æ·±å…¥è§£é‡Š Make å’Œ CMake çš„å·¥ä½œæœºåˆ¶
4. **æœ€ä½³å®è·µ**: å¼ºè°ƒ Modern CMake ç­‰ç°ä»£å¼€å‘æ–¹å¼
5. **Linux çŸ¥è¯†**: ç©¿æ’ç¼–è¯‘ã€é“¾æ¥ç­‰ç³»ç»Ÿåº•å±‚çŸ¥è¯†
6. **é—®é¢˜æ’æŸ¥**: è¯¦ç»†çš„è°ƒè¯•æŠ€å·§å’Œå¸¸è§é—®é¢˜è§£å†³

## ğŸ¯ é€‚åˆäººç¾¤

- C/C++ å¼€å‘è€…
- æƒ³å­¦ä¹ æ„å»ºç³»ç»Ÿçš„åˆå­¦è€…
- éœ€è¦ç»´æŠ¤ Makefile çš„å·¥ç¨‹å¸ˆ
- è¿›è¡Œè·¨å¹³å°å¼€å‘çš„å¼€å‘è€…
- å¯¹æ„å»ºç³»ç»ŸåŸç†æ„Ÿå…´è¶£çš„å­¦ä¹ è€…

## â“ å¸¸è§é—®é¢˜

### Make vs CMake å¦‚ä½•é€‰æ‹©ï¼Ÿ

| åœºæ™¯ | æ¨è |
|------|------|
| å°å‹å•å¹³å°é¡¹ç›® | Make |
| è·¨å¹³å°é¡¹ç›® | CMake |
| å¤§å‹ C++ é¡¹ç›® | CMake |
| å·²æœ‰ Makefile é¡¹ç›® | ç»§ç»­ä½¿ç”¨æˆ–é€æ­¥è¿ç§» |

### ç¤ºä¾‹ç¼–è¯‘å¤±è´¥ï¼Ÿ

```bash
# æ£€æŸ¥å·¥å…·
gcc --version
make --version
cmake --version

# å®‰è£…ä¾èµ–
sudo apt install build-essential cmake

# æŸäº›ç¤ºä¾‹éœ€è¦é¢å¤–çš„åº“
sudo apt install zlib1g-dev libssl-dev
```

### ç‰¹æ®Šç¤ºä¾‹è¯´æ˜

**Make 11-parallel-build**:
```bash
cd examples/make/11-parallel-build
bash generate.sh  # å…ˆç”Ÿæˆæµ‹è¯•æ–‡ä»¶
make -j4          # å¹¶è¡Œç¼–è¯‘
```

**CMake 06-find-package**:
```bash
sudo apt install zlib1g-dev  # å®‰è£…ä¾èµ–
cd examples/cmake/06-find-package
mkdir build && cd build
cmake .. && make
```

## ğŸ”§ æµ‹è¯•ç»“æœ

å·²å¯¹æ‰€æœ‰ç¤ºä¾‹è¿›è¡Œè‡ªåŠ¨åŒ–æµ‹è¯•ï¼š

- âœ… Make ç¤ºä¾‹ï¼š11/12 ç›´æ¥é€šè¿‡
- âœ… CMake ç¤ºä¾‹ï¼š13/13 å…¨éƒ¨é€šè¿‡

è¯¦ç»†æµ‹è¯•è¾“å‡ºå¯é€šè¿‡æµ‹è¯•è„šæœ¬æŸ¥çœ‹ã€‚

## ğŸ“š å‚è€ƒèµ„æº

### å®˜æ–¹æ–‡æ¡£
- [GNU Make æ‰‹å†Œ](https://www.gnu.org/software/make/manual/)
- [CMake å®˜æ–¹æ–‡æ¡£](https://cmake.org/documentation/)
- [Modern CMake](https://cliutils.gitlab.io/modern-cmake/)

### å¿«é€Ÿå‚è€ƒ
å‚è§æ•™ç¨‹ `05-appendix.md` çš„é€ŸæŸ¥è¡¨ç« èŠ‚ã€‚

## ğŸ¤ å¦‚ä½•ä½¿ç”¨

### å­¦ä¹ æ•™ç¨‹
1. ä» `tutorial/01-make-basics.md` å¼€å§‹
2. æŒ‰é¡ºåºé˜…è¯»å„ç« èŠ‚
3. è¿è¡Œå¯¹åº”çš„ç¤ºä¾‹ä»£ç 
4. ç†è§£åŸç†å¹¶å°è¯•ä¿®æ”¹

### è¿è¡Œç¤ºä¾‹
```bash
# Make ç¤ºä¾‹
cd examples/make/[ç¤ºä¾‹ç›®å½•]
make
./[å¯æ‰§è¡Œæ–‡ä»¶]
make clean

# CMake ç¤ºä¾‹
cd examples/cmake/[ç¤ºä¾‹ç›®å½•]
mkdir build && cd build
cmake ..
make
./[å¯æ‰§è¡Œæ–‡ä»¶]
```

### æ·±å…¥å­¦ä¹ 
1. æŸ¥çœ‹ `outline.md` äº†è§£å®Œæ•´å¤§çº²
2. é˜…è¯» `tutorial/05-appendix.md` è·å–æ›´å¤šèµ„æº
3. ç ”ç©¶ç¤ºä¾‹ä»£ç çš„ Makefile å’Œ CMakeLists.txt
4. åº”ç”¨åˆ°è‡ªå·±çš„é¡¹ç›®ä¸­

## ğŸ“ è®¸å¯è¯

æœ¬æ•™ç¨‹åŸºäº MIT è®¸å¯è¯å¼€æºã€‚

## ğŸ“ è‡´è°¢

æ„Ÿè°¢æ‰€æœ‰ä¸º Make å’Œ CMake å¼€å‘åšå‡ºè´¡çŒ®çš„å¼€å‘è€…ã€‚

---

**å¼€å§‹å­¦ä¹ ï¼š** [Make åŸºç¡€å…¥é—¨](tutorial/01-make-basics.md)

**ç¤ºä¾‹ä»£ç ï¼š** [examples/](examples/)

**å¿«é€Ÿå‚è€ƒï¼š** [é™„å½• - å‘½ä»¤é€ŸæŸ¥è¡¨](tutorial/05-appendix.md)
